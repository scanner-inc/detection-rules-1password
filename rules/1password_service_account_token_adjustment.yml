# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: 1Password Service Account Token Adjustment
description: |-
  Detect when a service account integration token has been created, renamed,
  verified, or revoked in 1Password. This can indicate an attacker attempting
  to use a non-user identity to compromise a 1Password tenant.
enabled: true
severity: Medium
query_text: |-
  @scnr.source_type:1password
  action:(create trename tverify trevoke)
  object_type:satoken
  | groupbycount(actor_details.email)
  | where @q.count > 0
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- medium_severity_alerts
tags:
- tactics.ta0005.defense_evasion
- techniques.t1134.access_token_manipulation
- source.1password
