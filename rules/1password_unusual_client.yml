# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: 1Password Unusual Client Detected
description: |-
  Detect unusual or unauthorized clients connecting to your 1Password account.

  This rule monitors for clients that are not in the following list:
  * 1Password CLI
  * 1Password for Web/Mac/Windows/Linux/iOS/Android
  * 1Password Browser Extension
  * 1Password SCIM Bridge
enabled: true
severity: Medium
query_text: |-
  @scnr.source_type:1password
  not client.app_name:('1Password CLI' '1Password for Web' '1Password for Mac' '1Password SCIM Bridge' '1Password for Windows' '1Password for iOS' '1Password Browser Extension' '1Password for Android' '1Password for Linux')
  | groupbycount(client.app_name)
  | where @q.count > 0
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- medium_severity_alerts
tags:
- tactics.ta0006.credential_access
- techniques.t1555.credentials_from_password_stores
- source.1password
