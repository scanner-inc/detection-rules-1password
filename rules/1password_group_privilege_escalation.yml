# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: 1Password Group Privilege Escalation
description: |-
  Detect when an actor joins a group or assigns themselves a role within a group,
  which may indicate insider threat activity or privilege escalation attempts.
enabled: true
severity: Medium
query_text: |-
  %ingest.source_type:1password
  action:(join role)
  object_type:gm
  | eval same_actor_and_target = (`actor_details.email` == `aux_details.email`)
  | where same_actor_and_target="true"
  | groupbycount(actor_details.email)
  | where @q.count > 0
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- medium_severity_alerts
tags:
- tactics.ta0004.privilege_escalation
- techniques.t1078.valid_accounts
- source.1password
